# YOLO 手部检测与全向轮机器人控制系统

基于YOLO的实时手部检测与三轮全向机器人视觉伺服控制系统

---

## 🎯 系统功能

- **🤲 实时手部检测**: 使用YOLO-FastestV2高效识别手部位置
- **🔄 全向移动**: 三轮麦克纳姆轮，360°自由移动
- **👁️ 视觉伺服**: 手部位置实时控制机器人运动
- **🌐 Web监控**: 浏览器实时查看画面和系统状态
- **⚡ 高性能**: 树莓派4上达到30FPS检测速度

---

## 🚀 快速上手

### 第一步：编译项目
```bash
make
```

### 第二步：运行程序
```bash
./scripts/run.sh
```

### 第三步：访问Web界面
打开浏览器访问：`http://<你的树莓派IP>:8080`

---

## 📁 项目结构

```
PROJ/
├── 📂 src/                    # 源代码目录
│   ├── 📄 main.cpp           # 主程序入口
│   ├── 📂 detection/         # YOLO手部检测模块
│   ├── 📂 control/           # 电机和运动控制
│   ├── 📂 vision/            # 视觉伺服算法
│   └── 📂 system/            # 系统监控
├── 📂 include/               # 头文件目录
├── 📂 lib/models/           # AI模型文件
├── 📂 resources/web/        # Web界面资源
├── 📂 bin/                  # 编译后的可执行文件
└── 📂 scripts/              # 运行脚本
```

---

## 🛠️ 环境要求

### 硬件要求
- **树莓派4B** (推荐) 或其他ARM64开发板
- **USB摄像头** 或 CSI摄像头
- **三个直流电机** 和电机驱动模块
- **电源供应** (5V 3A+)

### 软件要求
- **操作系统**: Raspberry Pi OS (推荐)
- **编译器**: GCC 7+ 支持C++17
- **依赖库**: OpenCV 4.x, NCNN, WiringPi

---

## 🎮 操作指南

### 基本命令
```bash
# 🔨 编译整个项目
make

# 🚀 运行主程序
./scripts/run.sh

# 🔧 测试电机控制
make run-test

# 🧹 清理编译文件
make clean

# ❓ 查看所有可用命令
make help
```

### Web界面功能
- **📹 实时视频**: 30FPS MJPEG视频流
- **📊 系统监控**: CPU、内存、温度实时显示
- **🔧 API接口**: `/system-info` 获取系统JSON数据

---

## ⚙️ 配置说明

### 电机接线图
```
电机1 (前方): IN1=GPIO17, IN2=GPIO6, PWM=GPIO26
电机2 (右后): IN1=GPIO20, IN2=GPIO12, PWM=GPIO16
电机3 (左后): IN1=GPIO22, IN2=GPIO27, PWM=GPIO23
```

### 检测参数设置
- **置信度阈值**: 0.6 (可调整)
- **输入分辨率**: 416x416像素
- **检测目标**: 手部 (hand)
- **处理速度**: 25-30 FPS

### 控制参数
```cpp
// PID控制参数
线性控制:  Kp=2.0, Ki=0.15, Kd=0.25
角度控制:  Kp=1.5, Ki=0.0,  Kd=0.3

// 死区设置
X轴死区: 15像素
Y轴死区: 35像素
```

---

## 🔧 故障排除

### 常见问题解决

**❌ 摄像头无法打开**
```bash
# 检查摄像头设备
ls /dev/video*
# 测试摄像头
sudo raspistill -o test.jpg
```

**❌ GPIO权限错误**
```bash
# 添加用户到gpio组
sudo usermod -a -G gpio $USER
# 重新登录生效
```

**❌ 编译失败**
```bash
# 检查依赖库
make check-deps
# 安装缺失依赖
make install-deps
```

**❌ 模型文件缺失**
```bash
# 确保模型文件在正确位置
ls -la lib/models/
# 应该包含:
# - yolo-fastestv2-opt.param
# - yolo-fastestv2-opt.bin
```

---

## 📊 性能指标

在树莓派4B上的测试结果：

| 指标 | 数值 | 说明 |
|------|------|------|
| 检测速度 | 25-30 FPS | 640x480分辨率 |
| 响应延迟 | <50ms | 从检测到电机响应 |
| 内存使用 | ~150MB | 运行时峰值 |
| CPU使用率 | 60-80% | 平均负载 |
| 网络延迟 | <10ms | 本地网络访问 |

---

## 🎯 使用场景

### 手势控制机器人
- 手掌移动 → 机器人跟随移动
- 手势变化 → 机器人停止或改变动作
- 实时响应 → 适合交互式应用

### 视觉追踪应用
- 物体追踪和抓取
- 自动导航和避障
- 人机交互界面

---

## 🔧 开发指南

### 添加新功能
1. 在对应模块目录添加源文件
2. 更新Makefile添加编译规则
3. 编写测试代码验证功能
4. 更新文档说明

### 调试模式
```bash
# 编译调试版本
make debug

# 使用GDB调试
gdb ./bin/main
```

### 性能优化
```bash
# 编译优化版本
make release

# 性能测试
make benchmark
```

---

## 📞 技术支持

如遇到问题：
1. 查看本README的故障排除部分
2. 检查项目的Issue页面
3. 提交新的Issue描述问题

---

**开发团队**: 陈泓熹
**最后更新**: 2025-12-09
**当前版本**: 2.0
**许可证**: BSD 3-Clause

---

## 🙏 致谢

- **NCNN框架** - 高效神经网络推理
- **OpenCV** - 开源计算机视觉库
- **WiringPi** - 树莓派GPIO控制库
- **YOLO** - 实时目标检测算法